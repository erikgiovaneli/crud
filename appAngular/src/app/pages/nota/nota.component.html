<div class="titulo">
  <h3>Tabela de Notas Fiscais</h3>
</div>
<br>
<dx-data-grid [dataSource]="nota" [remoteOperations]="true"
              [height]="600"
              [showBorders]="true"
              [showColumnLines]="true"
              (onSaved)="onSaved($event)">

  <dxo-editing
    mode="popup"
    [allowAdding]="true"
    [allowUpdating]="true"
    [allowDeleting]="true"
  >
    <dxo-popup title="Nota Fiscal" [showTitle]="true" [width]="500" [height]="500">
    </dxo-popup>

    <dxo-form colCount="3">
        <dxi-item dataField="id"></dxi-item>
        <dxi-item dataField="numero"></dxi-item>
        <dxi-item dataField="dataCriacao"></dxi-item>
        <dxi-item dataField="cliente" editorType="dxSelectBox" editorOptions="{ items: cliente, searchEnabled: true, value: '' }"></dxi-item>
        <dxi-item dataField="itens" [colSpan]="2"></dxi-item>
    </dxo-form>

  </dxo-editing>

  <dxi-column dataField="id" [allowEditing]="false" ></dxi-column>
  <dxi-column dataField="numero" dataType="number">
    <dxi-validation-rule type="required"></dxi-validation-rule>
  </dxi-column>
  <dxi-column dataField="dataCriacao" dataType="date">
    <dxi-validation-rule type="required"></dxi-validation-rule>
  </dxi-column>
  <dxo-master-detail [enabled]="true" template="detalhes">
    <dxi-column dataField="cliente" dataType="string">
      <dxi-validation-rule type="required"></dxi-validation-rule>
    </dxi-column>
    <dxi-column dataField="itens" dataType="string" editCellTemplate="itemCellTemplate">
    </dxi-column>
  </dxo-master-detail>

  <div *dxTemplate="let data of 'itemCellTemplate'" >
    <dx-data-grid [dataSource]="data.value"></dx-data-grid>
  </div>

  <div *dxTemplate="let notas of 'detalhes'">
    <dx-data-grid [dataSource]="nota" [showBorders]="true" [showColumnLines]="true">
    </dx-data-grid>
  </div>

</dx-data-grid>
